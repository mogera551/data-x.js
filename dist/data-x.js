(()=>{var e={108:e=>{function t(e){return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=()=>[],t.resolve=t,t.id=108,e.exports=t}},t={};function s(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,s),n.exports}s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";class e{static data={};static setData(e){Object.assign(this.data,e)}}class t{static filterByName=new Map;static regist(e,t){this.filterByName.set(e,t)}static forward(e,t){return e.reduce(((e,t)=>"forward"in t.filter?((e,t)=>e.filter.forward(t,e.options))(t,e):e),t)}static backward(e,t){return e.reduce(((e,t)=>"backward"in t.filter?((e,t)=>e.filter.backward(t,e.options))(t,e):e),t)}}class r{static root={};static setRoot(e){this.root=e}}class i{static VALUE=1;static CLASS=2;static RADIO=3;static CHECKBOX=4;static matchClass="class.";static matchRadio="radio";static matchCheckbox="checkbox";static getType(e){return e===this.matchRadio?this.RADIO:e===this.matchCheckbox?this.CHECKBOX:e.startsWith(this.matchClass)?this.CLASS:this.VALUE}static updateDomByValueType(e){const t=e.domProperty.split("."),s=e.filter.forward(e.forwardFilters,e.viewModel[e.path]),r=(e,t,i=e.shift())=>0===e.length?t[i]!==s&&(t[i]=s):r(e,t[i]);r(t,e.dom)}static updateDomByClassType(e){const t=e.domProperty.slice(this.matchClass.length);e.filter.forward(e.forwardFilters,e.viewModel[e.path])?!e.dom.classList.contains(t)&&e.dom.classList.add(t):e.dom.classList.contains(t)&&e.dom.classList.remove(t)}static updateDomByRadioType(e){const t=e.filter.forward(e.forwardFilters,e.viewModel[e.path]);e.dom.checked=e.dom.value===t}static updateDomByCheckboxType(e){const t=e.filter.forward(e.forwardFilters,e.viewModel[e.path]);e.dom.checked=(t??[]).includes(e.dom.value)}static updateViewModelByValueType(e){const t=e.domProperty.split("."),s=(e,t,r=e.shift())=>0===e.length?t[r]:s(e,t[r]);e.viewModel[e.path]=e.filter.backward(e.backwardFilters,s(t,e.dom))}static updateViewModelByClassType(e){const t=e.domProperty.slice(this.matchClass.length);e.viewModel[e.path]=e.dom.classList.contains(t)}static updateViewModelByRadioType(e){e.dom.checked&&(e.viewModel[e.path]=e.dom.value)}static updateViewModelByCheckboxType(e){const t=new Set(e.viewModel[e.path]??[]);e.dom.checked?t.add(e.dom.value):t.delete(e.dom.value),e.viewModel[e.path]=Array.from(t)}static#e={};static#t={};static init(){this.#e[this.VALUE]=this.updateDomByValueType,this.#e[this.CLASS]=this.updateDomByClassType,this.#e[this.RADIO]=this.updateDomByRadioType,this.#e[this.CHECKBOX]=this.updateDomByCheckboxType,this.#t[this.VALUE]=this.updateViewModelByValueType,this.#t[this.CLASS]=this.updateViewModelByClassType,this.#t[this.RADIO]=this.updateViewModelByRadioType,this.#t[this.CHECKBOX]=this.updateViewModelByCheckboxType}static updateDom(e,t=e.domPropertyType){Reflect.apply(this.#e[t],this,[e])}static updateViewModel(e,t=e.domPropertyType){Reflect.apply(this.#t[t],this,[e])}}class n{#s;#r;#i;#n;#o;#a;#l;#c;#p;#d;#h;#u;constructor(e,s,r){this.#r=e,this.#i=s.dom?.property,this.#n=r.viewModel,this.#o=s.viewModel?.property,this.#a=s.inputable,this.#h=class{static parse(e){return 0==e.length?[]:e.split("|").map((e=>e.split(":"))).map((([e,s])=>({name:e,options:s?.split(";")??[],filter:t.filterByName.get(e)})))}}.parse(s?.filters.join("|"))??[],this.#u=this.#h.slice().reverse(),this.#s=r,this.#l=r.indexes?.slice()??[],this.#d=i.getType(this.#i);const{path:n,pattern:o}=r.getPathInfo(this.#o);this.#c=n,this.#p=o}get dom(){return this.#r}get domProperty(){return this.#i}get viewModel(){return this.#n}get path(){return this.#c}get pattern(){return this.#p}get domPropertyType(){return this.#d}get forwardFilters(){return this.#h}get backwardFilters(){return this.#u}get filter(){return this.#s.filter}init(e=this.#a){e&&this.attachEvent(),this.updateDom()}updateDom(){i.updateDom(this)}updateViewModel(){i.updateViewModel(this)}attachEvent(e=this.#r,t=this.#s.viewUpdater){e.addEventListener("input",(e=>t.updateProcess((()=>this.updateViewModel()))))}}i.init();class o{nodes=[];loops;binds;key}class a{#r;#n;#o;#m=[];#s;#c;#p;#y;constructor(e,t,s){this.#r=e,this.#n=s.viewModel,this.#o=t.viewModel?.property,this.#s=s;const{path:r,pattern:i}=s.getPathInfo(this.#o);this.#c=r,this.#p=i,this.#y=s.loopStack.slice()}get dom(){return this.#r}get viewModel(){return this.#n}get path(){return this.#c}get pattern(){return this.#p}get children(){return this.#m}createChild(e,t=this.#r,s=this.#s){return s.pushLoop({loop:this,key:e},(()=>{const r=s.loopStack.map((e=>e.key));return s.pushIndexes(r,(()=>{const r=document.createDocumentFragment(),i=new o;i.key=e;const n=t.content.cloneNode(!0),a=s.viewBuilder.build(s,n);return i.binds=a.binds,i.loops=a.loops,r.appendChild(n),Array.from(r.childNodes).forEach((e=>i.nodes.push(e))),i}))}))}expand(){Object.keys(this.viewModel[this.path]).forEach((e=>{this.#m.push(this.createChild(e))}));const e=document.createDocumentFragment(),t=t=>e.appendChild(t);this.#m.forEach((e=>e.nodes.forEach(t))),this.#r.after(e)}restoreStack(e){const t=this.#y.slice(),s=t=>{if(0===t.length)return e();const r=t.pop();return context.pushLoop(r,s)};s(t)}removeChild(e){e.loops.forEach((e=>e.contract())),e.nodes.forEach((e=>e.parentNode.removeChild(e)))}contract(e=this.#m){e.forEach((e=>this.removeChild(e))),e.splice(0)}update(){this.contract(),this.restoreStack((()=>this.expand()))}}class l{#r;#s;#f;#g;#l;#x;#w;constructor(e,t,s){this.#r=e,this.#f=t,this.#g=t.dom?.event,this.#s=s,this.#l=s.indexes?.slice()??[],this.#x=this.getHandlerName()}get event(){return this.#g}get dom(){return this.#r}get handlerName(){return this.#x}init(){this.attachEvent()}getHandlerName(){const e=this.#r;return`${this.#g.toLowerCase()}${t=("x:name"in e?.dataset?e?.dataset["x:name"]:e?.name?.length>0?e.name:e.tagName).toLowerCase(),t?.length>0?t.at(0).toUpperCase()+t.slice(1):""}`;var t}async eventHandler(e,t=this.#s.viewModel,s=this.#s.eventHandler,r=this.handlerName,i=this.#l,n=this.#s){return n.pushIndexes(i,(async()=>s.exec(t,r,e,...i)))}attachEvent(e=this.#r,t=this.#g,s=this.#s.viewUpdater){e.addEventListener(t,(e=>s.updateProcess((async()=>await this.eventHandler(e)))))}}const c=":not([data-x\\:processed])",p="x:ignore",d=["[data-x\\:bind]","[data-x\\:loop]","[data-x\\:events]"].map((e=>`${e}${c}`)).join(","),h=["input","textarea","select","button"].map((e=>`${e}${c}`)).join(",");class u{static build(e,t,s=e.bindRules){const{loops:r,binds:i,events:o}=class{static inputable(e){return"INPUT"===e.tagName&&"button"!==e.type||"TEXTAREA"===e.tagName||"SELECT"===e.tagName}static testRadio(e){return"INPUT"===e.tagName&&"radio"===e.type}static testCheckbox(e){return"INPUT"===e.tagName&&"checkbox"===e.type}static parsePropertyName(e){const t=e.split("|");return{property:t.shift(),filters:t}}static parseDataBind(e,t,s=this.inputable(e),r=this.testRadio(e),i=this.testCheckbox(e)){const n=(e,t)=>{if(e.includes("=")){const[n,o]=e.split("="),{property:a,filters:l}=this.parsePropertyName(o);t.dom.property=n,t.viewModel.property=a,t.filters=l;const c=s?r?"radio":i?"checkbox":"value":"";t.inputable=c===n}else{const{property:n,filters:o}=this.parsePropertyName(e);t.dom.property=s?r?"radio":i?"checkbox":"value":"textContent",t.viewModel.property=n,t.filters=o,t.inputable=s}return t},o=t.split(",");if(1==o.length)return[n(t,{dom:{},viewModel:{},filters:[]})];{const e=o.map((e=>n(e,{dom:{},viewModel:{},filters:[]})));return e}}static collectByAttribute(e,t,s=[],r=[],i=[]){return Array.from(t.querySelectorAll(d)).forEach((t=>{if(p in t.dataset)return;const o=t.dataset["x:processing"]?.split(",")??[];if("x:loop"in t.dataset){if("TEMPLATE"!==t.tagName)return;if(o.includes("loop"))return;const s={dom:{},viewModel:{property:t.dataset["x:loop"]},filters:[]};r.push(new a(t,s,e)),o.push("loop")}else{if("x:bind"in t.dataset){if(o.includes("bind"))return;s.push(...this.parseDataBind(t,t.dataset["x:bind"]).map((s=>new n(t,s,e)))),o.push("bind")}if("x:events"in t.dataset){if(o.includes("events"))return;t.dataset["x:events"].split(",").forEach((s=>{const r={dom:{event:s},viewModel:{},filters:[]};i.push(new l(t,r,e))})),o.push("events")}}t.dataset["x:processing"]=o.join(",")})),{binds:s,loops:r,events:i}}static collectByImplicit(e,t,s=[],r=[],i=[]){return Array.from(t.querySelectorAll(h)).forEach((t=>{if(p in t.dataset)return;const r=t.dataset["x:processing"]?.split(",")??[],o=this.testRadio(t),a=this.testCheckbox(t),c={dom:{},viewModel:{},filters:[]};if("BUTTON"===t.tagName||"INPUT"===t.tagName&&"button"===t.type){if(r.includes("events"))return;c.dom.event="click",i.push(new l(t,c,e)),r.push("events")}else{if(r.includes("bind"))return;const{property:i,filters:l}=this.parsePropertyName(t.name);c.dom.property=o?"radio":a?"checkbox":"value",c.viewModel.property=i,c.filters=l,c.inputable=!0,s.push(new n(t,c,e)),r.push("bind")}t.dataset["x:processing"]=r.join(",")})),{binds:s,loops:r,events:i}}static collectByRule(e,t,s,r=[],i=[],o=[]){const d=new Map;return s.forEach((e=>{!d.has(e.dom.selector)&&d.set(e.dom.selector,[]),d.get(e.dom.selector).push(e)})),Array.from(d.keys()).forEach((s=>{t.querySelectorAll(`${s}${c}`).forEach((t=>{if(p in t.dataset)return;const c=this.inputable(t),h=t.dataset["x:processing"]?.split(",")??[],u=h.slice();d.get(s).forEach((s=>{const p=JSON.parse(JSON.stringify(s));if("TEMPLATE"===t.tagName){if(h.includes("loop"))return;((t,s)=>{i.push(new a(s,t,e))})(p,t),u.push("loop")}else if("event"in p.dom){if(h.includes("events"))return;((t,s)=>{o.push(new l(s,t,e))})(p,t),u.push("events")}else{if(h.includes("bind"))return;p.inputable=c,((t,s)=>{r.push(new n(s,t,e))})(p,t),u.push("bind")}})),t.dataset["x:processing"]=u.join(",")}))})),{loops:i,binds:r,events:o}}static collect(e,t,s=[]){const r=[],i=[],n=[];return this.collectByRule(e,t,s,r,i,n),this.collectByAttribute(e,t,r,i,n),this.collectByImplicit(e,t,r,i,n),r.forEach((e=>e.dom.dataset["x:processed"]="")),i.forEach((e=>e.dom.dataset["x:processed"]="")),n.forEach((e=>e.dom.dataset["x:processed"]="")),Array.from(t.querySelectorAll("[data-x\\:processing]")).forEach((e=>{e.removeAttribute("data-x:processing")})),{loops:i,binds:r,events:n}}}.collect(e,t,s);return r.forEach((e=>e.expand())),i.forEach((e=>e.init())),o.forEach((e=>e.init())),{loops:r,binds:i,events:o}}}class m{#b;#v;#P;#E;#N;#k;#M;#A;constructor(e,t){this.#P=e,this.#v=t}get name(){return this.#P}get data(){return this.#v}get block(){return this.#b}get root(){return this.#E}createBackLayer(e=this.#P){const t=document.createElement("div");t.dataset["x:dialog"]=e;const s=document.createElement("div");s.style.position="fixed",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-around",s.style.backgroundColor="rgba(0, 0, 0, 0.5)",s.style.left="0",s.style.top="0",s.style.height="100vh",s.style.width="100vw",s.style.zIndex="499",s.classList.add("bg"),s.addEventListener("click",(e=>this.cancelDialog())),t.appendChild(s);const r=document.createElement("div");return r.style.backgroundColor="white",r.style.borderRadius=".375rem",r.style.padding="2rem",r.classList.add("fg"),r.addEventListener("click",(e=>e.stopPropagation())),s.appendChild(r),{root:t,bg:s,fg:r}}async create(e=this.#P,t=this.#v,s=!1){const{root:r,bg:i,fg:n}=this.createBackLayer(e),o=await O.build(e,n,s,t,this);document.body.appendChild(r),this.#b=o,this.#E=r}cancelDialog(){this.#A&&this.#A()}closeDialog(e){this.#M&&this.#M(e)}async main(){return new Promise(((e,t)=>{this.#M=e,this.#A=t})).finally((()=>{this.#E.parentNode.removeChild(this.#E)}))}static async open(e,t={}){const s=new m(e,t);return s.create(),s.main()}}class y{name;pattern;indexes;lastName;parentName;constructor({name:e=null,pattern:t=null,indexes:s=null}){this.name=e,this.pattern=t,this.indexes=s,null==e&&null!=t&&null!=s&&(this.name=y.expand(t,s));const r=this.name.split(".");this.lastName=r.pop(),this.parentName=r.join(".")}static expand(e,t,s=t.slice()){return e.replaceAll("*",(()=>s.shift()))}static createByName(e){return new y({name:e})}static createByPatternIndexes(e,t){return new y({pattern:e,indexes:t})}}class f{static async exec(e,t,...s){const r=t[0].toUpperCase()+t.slice(1),i=`event${r}`,n=`on${r}`;if(i in e){const t=Object.getOwnPropertyDescriptor(e,i);return Reflect.apply(t.set,e,[s])}if(n in e)return e[n](...s)}}class g{static async init(e,t,s=e.viewModel,r=e.properties){const i=[];for(const e of r.values){const r=t=>e.name.includes(".")?s[e.name]=t:s[`__${e.name}`]=t;e?.init&&("AsyncFunction"===e.init.constructor.name?i.push(e.init(t).then((e=>r(e)))):r(e.init(t)))}return await Promise.all(i),f.exec(s,"init",t)}}class x{static reflect(e,t,s={}){Object.keys(t).forEach((r=>{const i=`$${r}`,n=t=>!1!==t&&e.$postUpdate((()=>{e.$notify(i),e.$notifyAll(i)})),o={configurable:!1,enumerable:!0,get:()=>Reflect.get(t,r),set:e=>{const s=Reflect.set(t,r,e);return s instanceof Promise?s.then(n):n(s),s}};Object.defineProperty(s,i,o)}))}}class w{#s;constructor(e){this.#s=e}build(e=this.#s,t=this.#s.viewBuilder,s=this.#s.rootElement){const r=t.build(e,s);e.setBindTree(r),e.buildBinds()}appear(e=this.#s){const t=e.parentElement.attachShadow({mode:"open"});t.appendChild(e.rootElement),e.rootElement=t}}class b{#s;#B=[];constructor(e){this.#s=e}registPostProcess(e){this.#B.push(e)}async postProcess(){const e=this.#B.slice();e.length>0&&this.updateProcess((async()=>{for(const t of e)t()}))}clearPostProcess(){this.#B.splice(0)}updateDom(e=this.#s.notifier,t=this.#s.allBinds,s=this.#s.allLoops,r=this.#s.dependencies){const i=[];e.queue.forEach((({name:e,indexes:t})=>i.push(...r.getReferedProperties(e,t),(({name:e,indexes:t})=>({name:y.expand(e,t),pattern:e,indexes:t}))({name:e,indexes:t}))));const n=new Set(i.map((e=>e.name)));s.filter((e=>n.has(e.path))).forEach((e=>e.update())),t.filter((e=>n.has(e.path))).forEach((e=>e.updateDom()))}async updateProcess(e,t=this.#s,s=this.#s.notifier,r=this.#s.properties){this.clearPostProcess(),s.clear(),r.clearStatus(),await e(),this.updateDom(),r.isUpdate&&t.buildBinds(),await this.postProcess()}}class v{parentNodes=[];name;func;childNodes=[];constructor(e){this.name=e}}class P{#R=new Map;#$;#s;constructor(e){this.#s=e}build(e=this.#R,t=this.#s.dependencyRules){e.clear(),this.#$=this.#s.dependencyRules.slice(),t.forEach((([t,s,r])=>this.add(e,t,s,r)))}add(e,t,s,r){e.has(t)||e.set(t,new v(t));const i=e.get(t);i.func=r,s.forEach((t=>{e.has(t)||e.set(t,new v(t));const s=e.get(t);i.childNodes.push(s),s.parentNodes.push(i)}))}getReferedProperties(e,t,s=this.#R){const r=s.get(e),i=(e,s)=>(null==e||(s.push({name:y.expand(e.name,t??[]),pattern:e.name,indexes:e.func?e.func(t):t}),e.parentNodes.forEach((e=>{s=i(e,s)}))),s),n=i(r,[]),o=[];return n.forEach((e=>{const t=new Set(o.map((e=>e.name)));t.has(e)||o.push(e)})),o}}class E{static PLAIN=1;static PATTERN=2;static EXPANDED=3}class N{#P;#p;#D;#T;#s;#S;#C;#L;#O=!0;#I=!1;#j;constructor(e,t,s,r,i,n){this.#s=e,this.#L=t,this.#P=s,this.#p=r,this.#S=i,this.#C=n;const o=s.split(".");this.#D=o.pop(),this.#T=o.join(".")}get context(){return this.#s}get name(){return this.#P}get pathParent(){return this.#T}get pathLastElement(){return this.#D}get desc(){return this.#S}get init(){return this.#C}get type(){return this.#L}get pattern(){return this.#p}get isArray(){return this.testIsArray()}get referedPatternProperties(){return this.getReferedPatternPeoperties()}get value(){return this.getValue()}get isNew(){return this.#O}get isUpdate(){return this.#I}get hasSetter(){return null!=this.desc.set}set desc(e){this.#S=e,Object.defineProperty(this.#s.viewModel,this.#P,e)}set isNew(e){this.#O=e}set isUpdate(e){this.#I=e}testIsArray(){return!1}getReferedPatternPeoperties(){return[]}getValue(){throw new Error("")}clearStatus(){this.isNew=!1,this.isUpdate=!1}static create(e,{name:t=null,desc:s={},patternProperty:r=null,patternIndexes:i=[],requireSetter:n=null,init:o=null}){return null!=r?new A(e,r,i):(null===n&&(n="set"in s),t.includes("*")?new M(e,t,s,n,o):new k(e,t,s,n,o))}}class k extends N{constructor(e,t,s,r,i){super(e,E.PLAIN,t,t,s,i),this.#U(r),this.#V()}testIsArray(e=this.name,t=this.context.properties){return t.testIsArray(e)}#U(e){this.context.viewModel;const t=this.context.cache,s=this.pathParent,r=this.pathLastElement,i=this.name.includes("."),n=`__${this.name}`,o=this.name,a=i?function(){return t.has(o)?t.get(o):t.set(o,this[s]?.[r])}:function(){return t.has(o)?t.get(o):t.set(o,this[n])},l=i?function(e){this[s][r]=e,t.delete(o)}:function(e){this[n]=e,this.isUpdate=!0,t.delete(o)},c=this.desc,p={configurable:!0,enumerable:!0,get:c.get?c.get:a};e&&(p.set=c.set?c.set:l),this.desc=p}#V(){const e=this.context.notifier,t=(this.context.properties,this.desc.set),s=this.desc,r=this.name;null!=s.set&&(s.set=async function(s){const i=Reflect.apply(t,this,[s]),n=t=>!1!==t&&e.notify(r);return i instanceof Promise?i.then(n):n(i),i},this.desc=s)}getReferedPatternPeoperties(e=this.context.properties,t=this.name){return e.getReferedPatternPeoperties(t)}getValue(){return Reflect.apply(this.desc.get,this.context.viewModel,[this.name])}}class M extends N{constructor(e,t,s,r,i){super(e,E.PATTERN,t,t,s),this.#U(r)}testIsArray(e=this.pattern,t=this.context.properties){return t.testIsArray(e)}#U(e){const t=this.context,s=(this.context.viewModel,this.pathParent),r=this.pathLastElement,i=this.pattern.split("").filter((e=>"*"===e)).length,n=this.desc,o={configurable:!0,enumerable:!0,get:n.get?n.get:function(){const e="*"===r?(t?.indexes??[]).at(i-1):r;return this[s]?.[e]}};e&&(o.set=n.set?n.set:function(e){const n="*"===r?(t?.indexes??[]).at(i-1):r;this[s][n]=e,this.isUpdate=!0}),this.desc=o}getReferedPatternPeoperties(e=this.context.properties,t=this.pattern){return e.getReferedPatternPeoperties(t)}}class A extends N{#q;#F;constructor(e,t,s){const r=y.expand(t.pattern,s);super(e,E.EXPANDED,r,t.pattern,null,t.init),this.#q=t,this.#F=s.slice(),this.#U()}get patternProperty(){return this.#q}get patternIndexes(){return this.#F}#U(){const e=this.context,t=this.context.cache,s=this.context.viewModel,r=this.context.notifier,i=(this.context.properties,this.patternProperty),n=this.patternIndexes,o=this.name,a={configurable:!0,enumerable:!0,get:()=>e.pushIndexes(n,(()=>t.has(o)?t.get(o):t.set(o,s[i.pattern])))};null!=i.desc.set&&(a.set=t=>{e.pushIndexes(n,(()=>{s[i.pattern]=t,r.notify(i.pattern,n)}))}),this.desc=a}testIsArray(e=this.patternProperty.pattern,t=this.context.properties){return t.testIsArray(e)}getReferedPatternPeoperties(e=this.patternProperty){return e.referedPatternProperties}getValue(){return Reflect.apply(this.desc.get,this.context.viewModel,[this.name])}}class B{#s;#H=new Map;#I=!1;constructor(e){this.#s=e}get names(){return Array.from(this.#H.keys())}get values(){return Array.from(this.#H.values())}build(e=this.#s,t=this.#s.viewModel){this.#H.clear();const s=Object.getPrototypeOf(t),r=e=>({configurable:!0,enumerable:!1,writable:!0,value:e?.value}),i=e=>/^\@\@?([a-zA-Z0-9_\.\*])+(#(get|set|init))?$/.test(e),n=e=>/^#(event[a-zA-Z0-9_]+)$/.test(e),o=e=>/^__([a-zA-Z0-9_])+$/.test(e),a=new Map;[t].forEach((e=>{Object.entries(Object.getOwnPropertyDescriptors(e)).forEach((([e,s])=>{if(i(e)||o(e)||n(e))if(o(e))Reflect.defineProperty(t,e,r(s));else if(i(e)){const[r,i]=e.includes("#")?e.split("#"):[e,null],n="@"===e.at(1),o=n?r.slice(2):r.slice(1),l=a.has(o)?a.get(o):{baseName:null,originalName:null,privateName:null,get:null,set:null,init:null,requireGet:!1,requireSet:!1,privateValue:void 0};l.baseName=l.baseName??o,l.originalName=l.originalName??r,l.privateName=l.privateName??`__${o}`,l.get="get"===i?s.value:l.get,l.set="set"===i?s.value:l.set,l.init="init"===i?s.value:l.init,l.requireGet=null==i||l.requireGet,l.requireSet=n,l.privateValue=null==i?s.value:l.privateValue,a.set(o,l),Reflect.deleteProperty(t,e)}else if(n(e)){const r=e,i="set",n=!0,o=r.slice(1),l=a.has(o)?a.get(o):{baseName:null,originalName:null,privateName:null,get:null,set:null,init:null,requireGet:!1,requireSet:!1,privateValue:void 0};l.baseName=l.baseName??o,l.originalName=l.originalName??r,l.privateName=l.privateName??`__${o}`,l.set="set"===i?s.value:l.set,l.requireGet=null==i||l.requireGet,l.requireSet=n,l.privateValue=null==i?s.value:l.privateValue,a.set(o,l),Reflect.deleteProperty(t,e)}}))})),Array.from(a.entries()).forEach((([i,n])=>{n.privateName in t||n.baseName.includes(".")||Reflect.defineProperty(t,n.privateName,r({value:n.privateValue}));const o=Object.getOwnPropertyDescriptor(t,i)??Object.getOwnPropertyDescriptor(s,i)??{};o.get=null!=n.get?n.get:o.get??null,o.set=null!=n.set?n.set:o.set??null;const a=n.init,l=n.requireSet,c=i;this.setProperty(N.create(e,{name:c,desc:o,requireSetter:l,init:a}))})),[t,s].forEach((t=>{Object.entries(Object.getOwnPropertyDescriptors(t)).forEach((([t,s])=>{this.#H.has(t)||(null!=s?.get?this.setProperty(N.create(e,{name:t,desc:s,requireSetter:null!=s?.set})):null!=s?.set&&this.setProperty(N.create(e,{name:t,desc:s,requireSetter:!0})))}))}));const l=[];for(const e of this.#H.keys()){const t=[],s=e.split("."),r=[];s.forEach((e=>{r.push(e),t.push(r.join("."))})),l.push(...t)}Array.from(new Set(l)).filter((e=>!this.#H.has(e))).forEach((r=>{const i=Object.getOwnPropertyDescriptor(t,r)??Object.getOwnPropertyDescriptor(s,r)??{};this.setProperty(N.create(e,{name:r,desc:i,requireSetter:!0}))})),Object.defineProperty(t,"$context",{get:()=>e})}removeProperty(e,t=this.#s.viewModel,s=this.#s.cache,r=this.#H){delete t[e],r.delete(e),s.delete(e)}getProperty(e,t=this.#H){return t.get(e)}setProperty(e,t=this.#H){t.set(e.name,e)}#_(e){const t=e.type===E.EXPANDED?e.patternIndexes:[],s=e.value,r=this.#s;e.referedPatternProperties.forEach((e=>{const i=e.pattern;(Object.keys(s)??[]).forEach((s=>{const n=t.concat(s);if(!y.expand(i,n).includes("*")){const t=N.create(r,{patternProperty:e,patternIndexes:n,requireSetter:e.hasSetter});this.setProperty(t),e.isArray&&this.#_(t)}}))}))}expand(e,t=null){const s=this.getProperty(e);null!=s&&this.#_(s)}#X(e){const t=(e.type===E.EXPANDED?e.patternIndexes:[]).join("\t"),s=e=>e.patternIndexes.join("\t").startsWith(t);e.referedPatternProperties.forEach((e=>{this.getExpandedPropertiesByPatternProperty(e).filter(s).forEach((e=>{this.removeProperty(e.name)}))}))}contract(e){const t=this.getProperty(e);null!=t&&this.#X(t)}testIsArray(e,t=this.#H){return t.has(`${e}.*`)}#z(e,t=this.#s.cache){t.delete(e);const s=this.getProperty(e);null!=s&&s.isArray&&(this.#X(s),this.#_(s))}updateByName(e,t=this.#s.cache){this.#z(e),this.#s.dependencies.getReferedProperties(e).forEach((t=>e!=t.name&&this.#z(t.name)))}updateByPatternIndexes({name:e,indexes:t}){const s=y.expand(e,t);this.updateByName(s)}expandAll(e=this.#H){Array.from(e.entries()).forEach((([e,t])=>{!e.includes("*")&&t.isArray&&this.#_(t)}))}has(e,t=this.#H){return t.has(e)}getReferedPatternPeoperties(e){const t=`${e}.`;return this.names.filter((e=>e.startsWith(t))).map((e=>this.getProperty(e))).filter((e=>e.type===E.PATTERN))}getExpandedPropertiesByPatternProperty(e){return this.values.filter((e=>e.type===E.EXPANDED)).filter((t=>t.patternProperty===e))}clearStatus(){return this.values.forEach((e=>e.clearStatus()))}get isUpdate(){return this.values.some((e=>e.isUpdate||e.isNew))}}class R{#W=[];#s;constructor(e){this.#s=e}get queue(){return this.#W}notify(e,t=[]){this.#W.push({name:e,indexes:t}),this.#s.properties.updateByPatternIndexes({name:e,indexes:t})}clear(){this.#W.splice(0)}}class ${#G=new Map;#s;constructor(e){this.#s=e}has(e){return this.#G.has(e)}get(e){return this.#G.get(e)}set(e,t){return this.#G.set(e,t),t}delete(e){this.#G.delete(e)}}class D{#K;#Q;#Z;#n;#J;#Y;#ee=[];#$=[];#te;#se={binds:[],loops:[]};#re=[];#ie=[];#y=[];#ne=[];#oe;#ae;#G;#le;#ce;#pe;#de;#b;#he;#ue;#v;#me;constructor(e,t){this.#b=e,this.#K=t}build(){this.#Z=new w(this),this.#J=u,this.#Y=new b(this),this.#te=new P(this),this.#oe=new B(this),this.#ae=new R(this),this.#G=new $(this),this.#pe=t,this.#de=r.root,this.#he=f,this.#ue=g,this.#v=e.data,this.#me=x}get parentElement(){return this.#K}get rootElement(){return this.#Q}get view(){return this.#Z}get viewModel(){return this.#n}get viewBuilder(){return this.#J}get viewUpdater(){return this.#Y}get bindRules(){return this.#ee}get dependencyRules(){return this.#$}get dependencies(){return this.#te}get bindTree(){return this.#se}get allBinds(){return this.#re}get allLoops(){return this.#ie}get indexesStack(){return this.#ne}get indexes(){return this.#ne[this.#ne.length-1]}get $1(){return this.indexes[0]}get $2(){return this.indexes[1]}get $3(){return this.indexes[2]}get $4(){return this.indexes[3]}get $5(){return this.indexes[4]}get $6(){return this.indexes[5]}get $7(){return this.indexes[6]}get $8(){return this.indexes[7]}get loopStack(){return this.#y}get currentLoop(){return this.#y[this.#y.length-1]}get properties(){return this.#oe}get notifier(){return this.#ae}get cache(){return this.#G}get context(){return this}get template(){return this.#le}get module(){return this.#ce}get filter(){return this.#pe}get rootBlock(){return this.#de}get block(){return this.#b}get eventHandler(){return this.#he}get initializer(){return this.#ue}get data(){return this.#v}get dataReflecter(){return this.#me}set rootElement(e){this.#Q=e}set viewModel(e){this.#n=e}set template(e){this.#le=e}set module(e){this.#ce=e}pushIndexes(e,t){this.#ne.push(e);try{return t()}finally{this.#ne.pop()}}pushLoop({loop:e,key:t},s){this.#y.push({loop:e,key:t});try{return s()}finally{this.#y.pop()}}getPathInfo(e,t=e,s=this.currentLoop?.loop,r=this.currentLoop?.key,i=this.indexes??[]){return"."===e[0]?"."===e?{path:`${s.path}.${r}`,pattern:`${s.pattern}.*`}:{path:`${s.path}.${r}.${e}`,pattern:`${s.pattern}.*.${e}`}:{path:y.expand(t,i),pattern:t}}setBindTree({binds:e,loops:t},s=this.bindTree){s.binds.splice(0),s.loops.splice(0),s.binds.push(...e),s.loops.push(...t)}buildBinds(e=this.bindTree,t=this.allBinds,s=this.allLoops){t.splice(0),s.splice(0);const r=e=>t.push(e),i=e=>s.push(e);e.binds.forEach(r),e.loops.forEach(i);const n=e=>{e.children.forEach((e=>{e.binds.forEach(r),e.loops.forEach(i),e.loops.forEach(n)}))};e.loops.forEach(n)}reflect(e,t){const s=Object.getPrototypeOf(this);if(Object.entries(Object.getOwnPropertyDescriptors(s)).forEach((([t,s])=>{if(null!=s?.get){const r={configurable:!0,enumerable:!0,get:(...e)=>Reflect.apply(s.get,this,e)};Object.defineProperty(e,t,r)}})),[["$notify","notify"],["$notifyAll","notifyAll"],["$inquiryAll","inquiryAll"],["$openDialog","openDialog"],["$postUpdate","postUpdate"]].forEach((([t,s])=>{const r={configurable:!0,enumerable:!1,value:"AsyncFunction"===t.constructor.name?async(...e)=>Reflect.apply(this[t],this,e):(...e)=>Reflect.apply(this[t],this,e)};Object.defineProperty(e,s,r)})),null!=t){this.$closeDialog=function(e){t.closeDialog(e)};const s={configurable:!0,enumerable:!1,value:(...e)=>Reflect.apply(this.$closeDialog,this,e)};Object.defineProperty(e,"closeDialog",s),this.$cancelDialog=function(){t.cancelDialog()};const r={configurable:!0,enumerable:!1,value:(...e)=>Reflect.apply(this.$cancelDialog,this,e)};Object.defineProperty(e,"cancelDialog",r)}}$notify(e,t=[]){this.notifier.notify(e,t)}$postUpdate(e){this.viewUpdater.registPostProcess(e)}async $notifyAll(e,t=[]){this.rootBlock.notifyAll(e,t,this.block)}async $inquiryAll(e,t,s){this.$postUpdate((()=>this.rootBlock.inquiryAll(e,t,s,this.block)))}async $openDialog(e,t={}){return m.open(e,t)}}class T{static spaPath;static filterPath;static localFilter;static setOptions(e,t){this.spaPath=t.spaPath??`${e}-spa`,this.localFilter=t.localFilter??!1,this.filterPath=this.localFilter?t.filterPath??`${this.spaPath}/module/filter`:null}}const S="--bind-",C="--bind-class-";class L{dom={selector:""};viewModel={};filters=[];static createBind(e,t,s,r){const i=new L;return i.dom.selector=e,i.dom.property=t,i.viewModel.property=s,i.filters.push(...r),i}static createEvent(e,t){const s=new L;return s.dom.selector=e,s.dom.event=t,s}static createLoop(e,t){const s=new L;return s.dom.selector=e,s.viewModel.property=t,s}static build(e){const t=[];for(let s=0;s<e.style.length;s++){const r=e.style[s],i=e.style.getPropertyValue(r).trim();if("--events"===r)for(const s of i.split(",")){const r=L.createEvent(e.selectorText,s);t.push(r)}else if("--loop"===r){const s=L.createLoop(e.selectorText,i);t.push(s)}else if(r.startsWith(C)){const s=i.split("|"),n=s.shift(),o=s,a=L.createBind(e.selectorText,"class."+r.slice(C.length),n,o);t.push(a)}else if(r.startsWith(S)){const s=i.split("|"),n=s.shift(),o=s,a=L.createBind(e.selectorText,r.slice(S.length).replaceAll("-","."),n,o);t.push(a)}}return t}}class O{#P;#s;#ye=[];#fe;constructor(e=null){this.#fe=e}get context(){return this.#s}get name(){return this.#P}createContext(e,t){return this.#P=e,this.#s=new D(this,t),this.#s.build(),this.#s}async load(e,t,s){const r=this.createContext(e,t),i=this.#fe;try{const{template:t,module:n}=await class{static async load(e,t){const[s,r,i,n]=await Promise.all([this.#ge(e).then((e=>{if(!e.ok)throw console.error("response.ok:",response.ok),console.error("esponse.status:",response.status),console.error("esponse.statusText:",response.statusText),new Error(e.statusText);return e.text()})).catch((t=>{throw console.log(t),`parts (${e}) load fail`})),new Promise(((t,s)=>{this.#xe(e).then((e=>{if(!e.ok)throw console.error("response.ok:",response.ok),console.error("esponse.status:",response.status),console.error("esponse.statusText:",response.statusText),new Error(e.statusText);return e.text()})).then((e=>{t(e)})).catch((e=>{t(null)}))})),this.#we(e).catch((e=>{throw console.error(e),e})),new Promise(((s,r)=>{t?this.#be(e).then((e=>{if(!e.ok)throw console.error("response.ok:",response.ok),console.error("esponse.status:",response.status),console.error("esponse.statusText:",response.statusText),new Error(e.statusText);return e.text()})).then((e=>{s(e)})).catch((e=>{r()})):s(null)}))]),o=this.#ve({name:e,html:s,css:r,bindCss:n});return document.body.appendChild(o),{template:o,module:i}}static async#we(e,t=T?.spaPath){if(null!=t&&(t.startsWith("https://")||t.startsWith("http://")))return import(`${t}/module/${e}.js`);{const s=document.baseURI.lastIndexOf("/");if(s>=0){const r=document.baseURI.slice(0,s+1);return import(`${r}${t}/module/${e}.js`)}return import(`${t}/module/${e}.js`)}}static async#ge(e,t=T?.spaPath){return fetch(`${t}/html/${e}.html`)}static async#xe(e,t=T?.spaPath){return fetch(`${t}/css/${e}.css`)}static async#be(e,t=T?.spaPath){return fetch(`${t}/css/${e}.bind.css`)}static#ve({name:e,html:t,css:s,bindCss:r}){const i=document.createElement("template");return i.innerHTML=t,null!=s&&(i.innerHTML="<style>\n"+s+"\n</style>\n"+i.innerHTML),null!=r&&(i.innerHTML='<style data-x:rules="bind">\n'+r+"\n</style>\n"+i.innerHTML),i.dataset.block=e,i}}.load(e,s);r.template=t,r.module=n,r.viewModel=n.default?.viewModel??(null!=n.default?.AppViewModel?Reflect.construct(n.default.AppViewModel,[]):{}),r.dependencyRules.push(...n.default?.dependencyRules??[]);const o=n.default?.context??n.default?._;null!=o&&r.reflect(o,i),r.rootElement=t.content.cloneNode(!0),r.bindRules.push(...class{static collect(e){const t=document.createElement("div");document.body.appendChild(t);const s=t.attachShadow({mode:"open"}),r=e.querySelector("style[data-x\\:rules='bind']"),i=[];if(null!=r){s.appendChild(r);const e=e=>e.ownerNode===r,t=Array.from(s.styleSheets).find(e);Array.from(t?.cssRules??[]).map((e=>i.push(...L.build(e))))}return document.body.removeChild(t),i}}.collect(r.rootElement)),console.log(n.default)}catch(e){throw e}}async buildView(t=e.data,s=this.#s){s.properties.build(),s.dependencies.build(),s.dataReflecter.reflect(s,t,s.viewModel);const r=s.initializer;await r.init(s,t),s.properties.expandAll(),s.view.build(),this.#ye.push(...await I.build(s.rootElement)),s.view.appear()}static async build(t,s,r,i=e.data,n=null){const o=new O(n);return await o.load(t,s,r),await o.buildView(i),o}async notifyAll(e,t,s){const r=this.#s.notifier,i=this.#s.viewModel,n=this.#s.eventHandler,o=this.#s.viewUpdater;for(const r of this.#ye)r.notifyAll(e,t,s);s!==this&&o.updateProcess((async()=>{const o=n.exec(i,"notifyAll",e,t,s),a=()=>r.notify(e);return o instanceof Promise?o.then(a):a(),o}))}async inquiryAll(e,t,s,r){const i=this.#s.viewModel,n=this.#s.eventHandler,o=this.#s.viewUpdater;for(const i of this.#ye)i.inquiryAll(e,t,s,r);r!==this&&o.updateProcess((async()=>n.exec(i,"inquiryAll",e,t,s,r)))}}class I{static async build(e){return await Promise.all((e=>Array.from(e.querySelectorAll("[data-x\\:block]")))(e).map((e=>(async e=>{const t=e.dataset["x:block"],s="x:withBindCss"in e.dataset;return O.build(t,e,s)})(e))))}}class j{#ye=[];async build(){this.#ye.push(...await I.build(document.body))}async notifyAll(e,t,s){for(const r of this.#ye)r.notifyAll(e,t,s)}async inquiryAll(e,t,s,r){for(const i of this.#ye)i.inquiryAll(e,t,s,r)}}t.regist("falsey",{forward:(e,t=[])=>!e}),t.regist("not",{forward:(e,t=[])=>!e}),t.regist("null",{forward:(e,t=[])=>null==e}),t.regist("style-display",{forward:(e,t=[])=>e?"":"none"}),t.regist("locale-string",{forward:(e,t=[])=>Number(e).toLocaleString()}),t.regist("fixed",{forward:(e,t=[])=>Number(e).toFixed(t[0]??0)}),t.regist("ge",{forward:(e,t=[])=>Number(e)>=Number(t[0]??0)}),t.regist("gt",{forward:(e,t=[])=>Number(e)>Number(t[0]??0)}),t.regist("le",{forward:(e,t=[])=>Number(e)<=Number(t[0]??0)}),t.regist("lt",{forward:(e,t=[])=>Number(e)<Number(t[0]??0)}),t.regist("number-value",{forward:(e,t=[])=>e?.toString()??"",backward:(e,t=[])=>""!==e?Number(e):null});window.datax=class{static root;static async boot(t={},i={}){e.setData(t),T.setOptions(this.getBaseName(),i),await class{static async registLocalFilter(e=T.localFilter,t=T.filterPath){if(e){const e=document.baseURI.lastIndexOf("/"),r=e>=0?document.baseURI.slice(0,e+1):"";await s(108)(`${r}${t}/regist.js`)}}}.registLocalFilter(),this.root=new j(this),r.setRoot(this.root),await this.root.build()}static getBaseName(){const e=location.href.split("/").pop();if(e){const t=e.split(".");return t.pop(),t.join(".")}return e}}})()})();