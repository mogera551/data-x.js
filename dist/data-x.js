(()=>{var t={108:t=>{function e(t){return Promise.resolve().then((()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}e.keys=()=>[],e.resolve=e,e.id=108,t.exports=e}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,s),a.exports}s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";class t{static data={};static setData(t){this.data=t}}class e{static root={};static setRoot(t){this.root=t}}class i{static filterByName=new Map;static regist(t,e){this.filterByName.set(t,e)}static forward(t,e){return t.reduce(((t,e)=>"forward"in e.filter?((t,e)=>t.filter.forward(e,t.options))(e,t):t),e)}static backward(t,e){return t.reduce(((t,e)=>"backward"in e.filter?((t,e)=>t.filter.backward(e,t.options))(e,t):t),e)}}class r{#t;#e;#s;#i;#r;#a;#n;#o;constructor(t,e){this.#s=t,this.#e=e}get name(){return this.#s}get data(){return this.#e}get block(){return this.#t}get root(){return this.#i}createBackLayer(t=this.#s){const e=document.createElement("div");e.dataset["x:dialog"]=t;const s=document.createElement("div");s.style.position="fixed",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-around",s.style.backgroundColor="rgba(0, 0, 0, 0.5)",s.style.left="0",s.style.top="0",s.style.height="100vh",s.style.width="100vw",s.style.zIndex="499",s.classList.add("bg"),s.addEventListener("click",(t=>this.cancelDialog())),e.appendChild(s);const i=document.createElement("div");return i.style.backgroundColor="white",i.style.borderRadius=".375rem",i.style.padding="2rem",i.classList.add("fg"),i.addEventListener("click",(t=>t.stopPropagation())),s.appendChild(i),{root:e,bg:s,fg:i}}async build(t=this.#s,e=this.#e,s=!1){const{root:i,bg:r,fg:a}=this.createBackLayer(t),n=await j.create({name:t,parentElement:a,withBindCss:s,data:e,dialog:this});document.body.appendChild(i),this.#t=n,this.#i=i}static async create(t=this.#s,e=this.#e,s=!1){return new r(t,e).build()}cancelDialog(){this.#o&&this.#o()}closeDialog(t){this.#n&&this.#n(t)}async main(){return new Promise(((t,e)=>{this.#n=t,this.#o=e})).finally((()=>{this.#i.parentNode.removeChild(this.#i)}))}static async open(t,e={}){return(await r.create(t,e)).main()}}class a{name;pattern;indexes;lastName;parentName;constructor({name:t=null,pattern:e=null,indexes:s=null}){this.name=t,this.pattern=e,this.indexes=s,null==t&&null!=e&&null!=s&&(this.name=a.expand(e,s));const i=this.name.split(".");this.lastName=i.pop(),this.parentName=i.join(".")}static expand(t,e,s=e.slice()){let i=!1;const r=t.replaceAll("*",(()=>s.shift()??(i=!0,"*")));return i?null:r}static createByName(t){return new a({name:t})}static createByPatternIndexes(t,e){return new a({pattern:t,indexes:e})}}class n{static async exec(t,e,...s){const i=e[0].toUpperCase()+e.slice(1),r=`event${i}`,a=`on${i}`;if(r in t){const e=Object.getOwnPropertyDescriptor(t,r);return Reflect.apply(e.set,t,[s])}if(a in t)return t[a](...s)}}class o{static async init(t,e,s=t.viewModel,i=t.properties){await n.exec(s,"init",e);for(const t of i.values){if(null==t?.init)continue;const i=t.init(e),r=i instanceof Promise?await i:i;t.name.includes(".")?s[t.name]=r:s[`__${t.name}`]=r}}}const l={suspend:Symbol("")};class c{static reflect(t,e,s={},i=t.notifier){Object.keys(e).forEach((r=>{const a=`$${r}`,n={configurable:!1,enumerable:!0,get:()=>Reflect.get(e,r),set:s=>{Reflect.set(e,r,s),i.notify(new Promise(((e,s)=>{t.$notifyAll(a),e({name:a})})))}};Object.defineProperty(s,a,n)}))}}class d{static VALUE=1;static CLASS=2;static RADIO=3;static CHECKBOX=4;static matchClass="class.";static matchRadio="radio";static matchCheckbox="checkbox";static getType(t){return t===this.matchRadio?this.RADIO:t===this.matchCheckbox?this.CHECKBOX:t.startsWith(this.matchClass)?this.CLASS:this.VALUE}static async getValue(t,e){const s=Object.getOwnPropertyDescriptor(t,e);return s?.get?await Reflect.apply(s.get,t,[]):t[e]}static async updateDomByValueType(t){const e=t.domProperty.split("."),s=await this.getValue(t.viewModel,t.path),i=(t,e,s,r=t.shift())=>0===t.length?e[r]!==s&&(e[r]=s):i(t,e[r],s),r=s=>i(e,t.dom,t.filter.forward(t.forwardFilters,s));s instanceof Promise?s.then((t=>r(t))):r(s)}static async updateDomByClassType(t){const e=t.domProperty.slice(this.matchClass.length),s=await this.getValue(t.viewModel,t.path),i=s=>t.filter.forward(t.forwardFilters,s)?!t.dom.classList.contains(e)&&t.dom.classList.add(e):t.dom.classList.contains(e)&&t.dom.classList.remove(e);s instanceof Promise?s.then((t=>i(t))):i(s)}static async updateDomByRadioType(t){const e=await this.getValue(t.viewModel,t.path),s=e=>t.dom.checked=t.dom.value===t.filter.forward(t.forwardFilters,e);e instanceof Promise?e.then((t=>s(t))):s(e)}static async updateDomByCheckboxType(t){const e=await this.getValue(t.viewModel,t.path),s=e=>t.dom.checked=(t.filter.forward(t.forwardFilters,e)??[]).includes(t.dom.value);e instanceof Promise?e.then((t=>s(t))):s(e)}static async setValue(t,e,s){const i=Object.getOwnPropertyDescriptor(t,e);i?.set?await Reflect.apply(i.set,t,[s]):bind.viewModel[e]=s}static async updateViewModelByValueType(t){const e=t.domProperty.split("."),s=(t,e,i=t.shift())=>0===t.length?e[i]:s(t,e[i]),i=t.filter.backward(t.backwardFilters,s(e,t.dom));await this.setValue(t.viewModel,t.path,i)}static async updateViewModelByClassType(t){const e=t.domProperty.slice(this.matchClass.length),s=t.dom.classList.contains(e);await this.setValue(t.viewModel,t.path,s)}static async updateViewModelByRadioType(t){if(t.dom.checked){const e=t.dom.value;await this.setValue(t.viewModel,t.path,e)}}static async updateViewModelByCheckboxType(t){const e=new Set(t.viewModel[t.path]??[]);t.dom.checked?e.add(t.dom.value):e.delete(t.dom.value);const s=Array.from(e);await this.setValue(t.viewModel,t.path,s)}static#l={};static#c={};static init(){this.#l[this.VALUE]=this.updateDomByValueType,this.#l[this.CLASS]=this.updateDomByClassType,this.#l[this.RADIO]=this.updateDomByRadioType,this.#l[this.CHECKBOX]=this.updateDomByCheckboxType,this.#c[this.VALUE]=this.updateViewModelByValueType,this.#c[this.CLASS]=this.updateViewModelByClassType,this.#c[this.RADIO]=this.updateViewModelByRadioType,this.#c[this.CHECKBOX]=this.updateViewModelByCheckboxType}static async updateDom(t,e=t.domPropertyType){await Reflect.apply(this.#l[e],this,[t])}static async updateViewModel(t,e=t.domPropertyType){await Reflect.apply(this.#c[e],this,[t])}}class p{#d;#p;#h;#u;#m;#f;#y;#g;#w;#b;#x;#P;constructor(t,e,s){this.#p=t,this.#h=e.dom?.property,this.#u=s.viewModel,this.#m=e.viewModel?.property,this.#f=e.inputable,this.#x=class{static parse(t){return 0==t.length?[]:t.split("|").map((t=>t.split(":"))).map((([t,e])=>({name:t,options:e?.split(";")??[],filter:i.filterByName.get(t)})))}}.parse(e?.filters.join("|"))??[],this.#P=this.#x.slice().reverse(),this.#d=s,this.#y=s.indexes?.slice()??[],this.#b=d.getType(this.#h);const{path:r,pattern:a}=s.getPathInfo(this.#m);this.#g=r,this.#w=a}get dom(){return this.#p}get domProperty(){return this.#h}get viewModel(){return this.#u}get path(){return this.#g}get pattern(){return this.#w}get domPropertyType(){return this.#b}get forwardFilters(){return this.#x}get backwardFilters(){return this.#P}get filter(){return this.#d.filter}async init(t=this.#f){t&&this.attachEvent(),await this.updateDom()}async updateDom(){await d.updateDom(this)}async#v(){await d.updateViewModel(this)}attachEvent(t=this.#p,e=this.#d,s=e.view){t.addEventListener("input",(async t=>{await e.$updateProcess((()=>this.#v()))}))}}d.init();class h{nodes=[];loops;binds;key}class u{#p;#m;#k=[];#d;#g;#w;#E;constructor(t,e,s){this.#p=t,this.#m=e.viewModel?.property,this.#d=s;const{path:i,pattern:r}=s.getPathInfo(this.#m);this.#g=i,this.#w=r,this.#E=s.loopStack.slice()}get dom(){return this.#p}get path(){return this.#g}get pattern(){return this.#w}get children(){return this.#k}async#N(t,e=this.#p,s=this.#d){return s.pushLoop({loop:this,key:t},(()=>{const i=s.loopStack.map((t=>t.key));return s.pushIndexes(i,(async()=>{const i=document.createDocumentFragment(),r=new h,a=e.content.cloneNode(!0),{binds:n,loops:o}=await s.view.createBindTree(s,a);return Object.assign(r,{key:t,binds:n,loops:o}),i.appendChild(a),r.nodes.push(...Array.from(i.childNodes)),r}))}))}async expand(t=this.#d.viewModel,e=this.#g,s=this.#k,i=this.#p){const r=await t[e];for(const t of Object.keys(r))s.push(await this.#N(t));const a=document.createDocumentFragment(),n=t=>a.appendChild(t);s.forEach((t=>t.nodes.forEach(n))),i.after(a)}#M(t){const e=this.#E.slice(),s=e=>{if(0===e.length)return t();const i=e.pop();return context.pushLoop(i,s)};return s(e)}#B(t){t.loops.forEach((t=>t.contract())),t.nodes.forEach((t=>t.parentNode.removeChild(t)))}contract(t=this.#k){t.forEach((t=>this.#B(t))),t.splice(0)}async update(){this.contract(),await this.#M((async()=>this.expand()))}}class m{#p;#d;#A;#y;#R;constructor(t,e,s){this.#p=t,this.#A=e.dom?.event,this.#d=s,this.#y=s.indexes?.slice()??[],this.#R=this.#D()}get event(){return this.#A}get dom(){return this.#p}init(){this.#C()}#D(){const t=this.#p;return`${this.#A.toLowerCase()}${e="x:name"in t?.dataset?t?.dataset["x:name"]:t?.name?.length>0?t.name:t.tagName.toLowerCase(),e?.length>0?e.at(0).toUpperCase()+e.slice(1):""}`;var e}async#$(t,e=this.#d.viewModel,s=this.#d.eventHandler,i=this.#R,r=this.#y,a=this.#d){return a.pushIndexes(r,(()=>s.exec(e,i,t,...r)))}#C(t=this.#p,e=this.#A,s=this.#d,i=s.view){t.addEventListener(e,(async t=>{await s.$updateProcess((()=>this.#$(t)))}))}}const f=":not([data-x\\:processed])",y="x:ignore",g=["[data-x\\:bind]","[data-x\\:loop]","[data-x\\:events]"].map((t=>`${t}${f}`)).join(","),w=["input","textarea","select","button"].map((t=>`${t}${f}`)).join(",");class b{static async createBindTree(t,e,s=t.bindRules){const{loops:i,binds:r,events:a}=class{static inputable(t){return"INPUT"===t.tagName&&"button"!==t.type||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||!0===t?.isContentEditable}static testRadio(t){return"INPUT"===t.tagName&&"radio"===t.type}static testCheckbox(t){return"INPUT"===t.tagName&&"checkbox"===t.type}static parsePropertyName(t){const e=t.split("|");return{property:e.shift(),filters:e}}static parseDataBind(t,e,s=this.inputable(t),i=this.testRadio(t),r=this.testCheckbox(t)){const a=(e,a)=>{if(e.includes("=")){const[n,o]=e.split("="),{property:l,filters:c}=this.parsePropertyName(o);a.dom.property=n,a.viewModel.property=l,a.filters=c;const d=new Set(s?i?["radio"]:r?["checked","checkbox"]:t.isContentEditable?["textContent"]:["value"]:[]);a.inputable=d.has(n)}else{const{property:n,filters:o}=this.parsePropertyName(e);a.dom.property=s?i?"radio":r?"checkbox":t.isContentEditable?"textContent":"value":"textContent",a.viewModel.property=n,a.filters=o,a.inputable=s}return a},n=e.split(",");if(1==n.length)return[a(e,{dom:{},viewModel:{},filters:[]})];{const t=n.map((t=>a(t,{dom:{},viewModel:{},filters:[]})));return t}}static collectByAttribute(t,e,s=[],i=[],r=[]){return Array.from(e.querySelectorAll(g)).forEach((e=>{if(y in e.dataset)return;const a=e.dataset["x:processing"]?.split(",")??[];if("x:loop"in e.dataset){if("TEMPLATE"!==e.tagName)return;if(a.includes("loop"))return;const s={dom:{},viewModel:{property:e.dataset["x:loop"]},filters:[]};i.push(new u(e,s,t)),a.push("loop")}else{if("x:bind"in e.dataset){if(a.includes("bind"))return;s.push(...this.parseDataBind(e,e.dataset["x:bind"]).map((s=>new p(e,s,t)))),a.push("bind")}if("x:events"in e.dataset){if(a.includes("events"))return;e.dataset["x:events"].split(",").forEach((s=>{const i={dom:{event:s},viewModel:{},filters:[]};r.push(new m(e,i,t))})),a.push("events")}}e.dataset["x:processing"]=a.join(",")})),{binds:s,loops:i,events:r}}static collectByImplicit(t,e,s=[],i=[],r=[]){return Array.from(e.querySelectorAll(w)).forEach((e=>{if(y in e.dataset)return;const i=e.dataset["x:processing"]?.split(",")??[],a=this.testRadio(e),n=this.testCheckbox(e),o={dom:{},viewModel:{},filters:[]};if("BUTTON"===e.tagName||"INPUT"===e.tagName&&"button"===e.type){if(i.includes("events"))return;o.dom.event="click",r.push(new m(e,o,t)),i.push("events")}else{if(i.includes("bind"))return;const{property:r,filters:l}=this.parsePropertyName(e.name);o.dom.property=a?"radio":n?"checkbox":"value",o.viewModel.property=r,o.filters=l,o.inputable=!0,s.push(new p(e,o,t)),i.push("bind")}e.dataset["x:processing"]=i.join(",")})),{binds:s,loops:i,events:r}}static collectByRule(t,e,s,i=[],r=[],a=[]){const n=new Map;return s.forEach((t=>{!n.has(t.dom.selector)&&n.set(t.dom.selector,[]),n.get(t.dom.selector).push(t)})),Array.from(n.keys()).forEach((s=>{e.querySelectorAll(`${s}${f}`).forEach((e=>{if(y in e.dataset)return;const o=this.inputable(e),l=e.dataset["x:processing"]?.split(",")??[],c=l.slice();n.get(s).forEach((s=>{const n=JSON.parse(JSON.stringify(s));if("TEMPLATE"===e.tagName){if(l.includes("loop"))return;((e,s)=>{r.push(new u(s,e,t))})(n,e),c.push("loop")}else if("event"in n.dom){if(l.includes("events"))return;((e,s)=>{a.push(new m(s,e,t))})(n,e),c.push("events")}else{if(l.includes("bind"))return;n.inputable=o,((e,s)=>{i.push(new p(s,e,t))})(n,e),c.push("bind")}})),e.dataset["x:processing"]=c.join(",")}))})),{loops:r,binds:i,events:a}}static collect(t,e,s=[]){const i=[],r=[],a=[];return this.collectByRule(t,e,s,i,r,a),this.collectByAttribute(t,e,i,r,a),this.collectByImplicit(t,e,i,r,a),i.forEach((t=>t.dom.dataset["x:processed"]="")),r.forEach((t=>t.dom.dataset["x:processed"]="")),a.forEach((t=>t.dom.dataset["x:processed"]="")),Array.from(e.querySelectorAll("[data-x\\:processing]")).forEach((t=>{t.removeAttribute("data-x:processing")})),{loops:r,binds:i,events:a}}}.collect(t,e,s);return await Promise.all(i.map((t=>t.expand()))),await Promise.all(r.map((t=>t.init()))),a.forEach((t=>t.init())),{loops:i,binds:r,events:a}}static async build(t,e=t.rootElement){const s=await this.createBindTree(t,e);t.setBindTree(s),t.buildBinds()}static appear(t,e=t.fragment,s=t.parentElement){const i=s.attachShadow({mode:"open"});i.appendChild(e),t.rootElement=i}static attachTo(t,e){t.parentElement=e,this.appear(t)}static async updateDom(t,e=t.updateQueue,s=t.allBinds,i=t.allLoops,r=t.properties,a=t.viewModel){const n=await Promise.all(e),o=[];for(const{name:t,indexes:e=[]}of n.filter((t=>null!=t))){const s=await r.updateByPatternIndexes({name:t,indexes:e});o.push(...Array.from(s))}const l=new Set(o.map((t=>t.name)));await Promise.all(Array.from(l).map((t=>Reflect.get(a,t)))),await Promise.all(i.filter((t=>l.has(t.path))).map((t=>t.update()))),await Promise.all(s.filter((t=>l.has(t.path))).map((t=>t.updateDom()))),r.isUpdate&&t.buildBinds()}static async postProcess(t,e=t.postProcess){e.exec()}static async updateProcess(t,e,s=t.notifier,i=t.properties,r=t.postProcess){r.clear(),s.clear(),i.clearStatus(),await e(),await this.updateDom(t),i.isUpdate&&t.buildBinds(),await r.exec()}}class x{parentNodes=[];name;func;childNodes=[];constructor(t){this.name=t}}class P{#T=new Map;#S;#d;constructor(t){this.#d=t}get map(){return this.#T}build(t=this.#T,e=this.#d.dependencyRules){t.clear(),this.#S=this.#d.dependencyRules.slice(),e.forEach((([t,e,s])=>this.add(t,e,s))),this.implicitDependency()}implicitDependency(t=this.#d.properties){for(const e of t.names)t.getDependencyNames(e).forEach((t=>this.add(t,[e])))}add(t,e,s,i=this.#T){i.has(t)||i.set(t,new x(t));const r=i.get(t);r.func=s,e.forEach((t=>{i.has(t)||i.set(t,new x(t));const e=i.get(t);r.childNodes.push(e),e.parentNodes.push(r)}))}getReferedProperties(t,e,s=this.#T,i=this.#d.viewModel){const r=s.get(t),n=new Set,o=e??[],l=(t,e)=>{if(null==t)return e;const s=a.expand(t.name,o);if(null!==s){if(n.has(s))return e;n.add(s);const r=t.func?Reflect.apply(t.func,i,[o]):o;if(!1===r)return e;const a={name:s,pattern:t.name,indexes:r};e.push(a)}return t.parentNodes.forEach((t=>{e=l(t,e)})),e};return l(r,[])}}class v{static PLAIN=1;static PATTERN=2;static EXPANDED=3}class k{#s;#w;#O;#L;#d;#I;#j;#V;#q=!0;#U=!1;#_;constructor(t,e,s,i,r,a){this.#d=t,this.#V=e,this.#s=s,this.#w=i,this.#I=r,this.#j=a;const n=s.split(".");this.#O=n.pop(),this.#L=n.join(".")}get context(){return this.#d}get name(){return this.#s}get pathParent(){return this.#L}get pathLastElement(){return this.#O}get desc(){return this.#I}get init(){return this.#j}get type(){return this.#V}get pattern(){return this.#w}get isArray(){return this.testIsArray()}get referedPatternProperties(){return this.getReferedPatternPeoperties()}get value(){return this.getValue()}get isNew(){return this.#q}get isUpdate(){return this.#U}get hasSetter(){return null!=this.desc.set}set desc(t){this.#I=t,Object.defineProperty(this.#d.viewModel,this.#s,t)}set isNew(t){this.#q=t}set isUpdate(t){this.#U=t}testIsArray(){return!1}getReferedPatternPeoperties(){return[]}getValue(){throw new Error("")}clearStatus(){this.isNew=!1,this.isUpdate=!1}static create(t,{name:e=null,desc:s={},patternProperty:i=null,patternIndexes:r=[],requireSetter:a=null,init:n=null}){return null!=i?new M(t,i,r):(null===a&&(a="set"in s),e.includes("*")?new N(t,e,s,a,n):new E(t,e,s,a,n))}}class E extends k{constructor(t,e,s,i,r){super(t,v.PLAIN,e,e,s,r),this.#F(i)}testIsArray(t=this.name,e=this.context.properties){return e.testIsArray(t)}#F(t){this.context.viewModel;const e=this.context.notifier,s=this.context.cache,i=this.pathParent,r=this.pathLastElement,a=this.name.includes("."),n=`__${this.name}`,o=this.name,c=this.desc,d=a?function(t){const a=c.set?Reflect.apply(c.set,this,[t]):this[i][r]=t;this.isUpdate=!0,s.delete(o),e.notify(new Promise((async(t,e)=>{const s={name:o};t(await a!==l.suspend?s:null)})))}:function(t){const i=c.set?Reflect.apply(c.set,this,[t]):this[n]=t;this.isUpdate=!0,s.delete(o),e.notify(new Promise((async(t,e)=>{const s={name:o};t(await i!==l.suspend?s:null)})))},p={configurable:!0,enumerable:!0,get:a?function(){return s.has(o)?s.get(o):s.set(o,c.get?Reflect.apply(c.get,this,[]):this[i]?.[r])}:function(){return s.has(o)?s.get(o):s.set(o,c.get?Reflect.apply(c.get,this,[]):this[n])}};t&&(p.set=d),this.desc=p}getReferedPatternPeoperties(t=this.context.properties,e=this.name){return t.getReferedPatternPeoperties(e)}getValue(){return Reflect.apply(this.desc.get,this.context.viewModel,[this.name])}}class N extends k{constructor(t,e,s,i,r){super(t,v.PATTERN,e,e,s),this.#F(i)}testIsArray(t=this.pattern,e=this.context.properties){return e.testIsArray(t)}#F(t){const e=this.context,s=(this.context.viewModel,this.pathParent),i=this.pathLastElement,r=this.pattern.split("").filter((t=>"*"===t)).length,a=this.desc,n={configurable:!0,enumerable:!0,get:a.get?a.get:function(){const t="*"===i?(e?.indexes??[]).at(r-1):i;return this[s]?.[t]}};t&&(n.set=a.set?a.set:function(t){const a="*"===i?(e?.indexes??[]).at(r-1):i;this[s][a]=t,this.isUpdate=!0}),this.desc=n}getReferedPatternPeoperties(t=this.context.properties,e=this.pattern){return t.getReferedPatternPeoperties(e)}}class M extends k{#H;#X;constructor(t,e,s){const i=a.expand(e.pattern,s);super(t,v.EXPANDED,i,e.pattern,null,e.init),this.#H=e,this.#X=s.slice(),this.#F()}get patternProperty(){return this.#H}get patternIndexes(){return this.#X}#F(){const t=this.context,e=this.context.cache,s=this.context.viewModel,i=this.context.notifier,r=(this.context.properties,this.patternProperty),a=this.patternIndexes,n=this.name,o={configurable:!0,enumerable:!0,get:()=>t.pushIndexes(a,(()=>e.has(n)?e.get(n):e.set(n,s[r.pattern])))};null!=r.desc.set&&(o.set=o=>t.pushIndexes(a,(()=>{const t=Reflect.apply(r.desc.set,s,[o]);this.isUpdate=!0,e.delete(n),i.notify(new Promise((async(e,s)=>{const i={name:r.pattern,indexes:a};e(await t!==l.suspend?i:null)})))}))),this.desc=o}testIsArray(t=this.patternProperty.pattern,e=this.context.properties){return e.testIsArray(t)}getReferedPatternPeoperties(t=this.patternProperty){return t.referedPatternProperties}getValue(){return Reflect.apply(this.desc.get,this.context.viewModel,[this.name])}}class B{#d;#z=new Map;#U=!1;constructor(t){this.#d=t}get names(){return Array.from(this.#z.keys())}get values(){return Array.from(this.#z.values())}build(t=this.#d,e=this.#d.viewModel){this.#z.clear();const s=Object.getPrototypeOf(e),i=t=>({configurable:!0,enumerable:!1,writable:!0,value:t?.value}),r=t=>/^\@\@?([a-zA-Z0-9_\.\*])+(#(get|set|init)?)?$/.test(t),a=t=>/^#(event[a-zA-Z0-9_]+)$/.test(t),n=t=>/^__([a-zA-Z0-9_])+$/.test(t),o=new Map;[e].forEach((t=>{Object.entries(Object.getOwnPropertyDescriptors(t)).forEach((([t,s])=>{if(r(t)||n(t)||a(t))if(n(t))Reflect.defineProperty(e,t,i(s));else if(r(t)){const[i,r]=t.includes("#")?t.split("#"):[t,null],a="@"===t.at(1),n=a?i.slice(2):i.slice(1),l=o.has(n)?o.get(n):{baseName:null,originalName:null,privateName:null,get:null,set:null,init:null,requireGet:!1,requireSet:!1,privateValue:void 0};l.baseName=l.baseName??n,l.originalName=l.originalName??i,l.privateName=l.privateName??`__${n}`;const c=t=>"function"==typeof t&&0===t.length?t:console.error(`${n}.getter is not function() {}`),d=t=>"function"==typeof t&&1===t.length?t:console.error(`${n}.setter is not function(value) {}`);""===r?(l.get=s?.value?.get?c(s.value.get):l.get,l.set=s?.value?.set?d(s.value.set):l.set,l.init=s?.value?.init?s.value.init:l.init):(l.get="get"===r?c(s.value):l.get,l.set="set"===r?d(s.value):l.set,l.init="init"===r?s.value:l.init),l.requireGet=null==r||l.requireGet,l.requireSet=a,l.privateValue=null==r?s.value:l.privateValue,o.set(n,l),Reflect.deleteProperty(e,t)}else if(a(t)){const i=t,r="set",a=!0,n=i.slice(1),l=o.has(n)?o.get(n):{baseName:null,originalName:null,privateName:null,get:null,set:null,init:null,requireGet:!1,requireSet:!1,privateValue:void 0};l.baseName=l.baseName??n,l.originalName=l.originalName??i,l.privateName=l.privateName??`__${n}`,l.set="set"===r?s.value:l.set,l.requireGet=null==r||l.requireGet,l.requireSet=a,l.privateValue=null==r?s.value:l.privateValue,o.set(n,l),Reflect.deleteProperty(e,t)}}))})),Array.from(o.entries()).forEach((([r,a])=>{a.privateName in e||a.baseName.includes(".")||Reflect.defineProperty(e,a.privateName,i({value:a.privateValue}));const n=Object.getOwnPropertyDescriptor(e,r)??Object.getOwnPropertyDescriptor(s,r)??{};n.get=null!=a.get?a.get:n.get??null,n.set=null!=a.set?a.set:n.set??null;const o=a.init,l=a.requireSet,c=r;this.setProperty(k.create(t,{name:c,desc:n,requireSetter:l,init:o}))})),[e,s].forEach((e=>{Object.entries(Object.getOwnPropertyDescriptors(e)).forEach((([e,s])=>{this.#z.has(e)||(null!=s?.get?this.setProperty(k.create(t,{name:e,desc:s,requireSetter:null!=s?.set})):null!=s?.set&&this.setProperty(k.create(t,{name:e,desc:s,requireSetter:!0})))}))}));const l=[];for(const t of this.#z.keys()){const e=[],s=t.split("."),i=[];s.forEach((t=>{i.push(t),e.push(i.join("."))})),l.push(...e)}Array.from(new Set(l)).filter((t=>!this.#z.has(t))).forEach((i=>{const r=Object.getOwnPropertyDescriptor(e,i)??Object.getOwnPropertyDescriptor(s,i)??{};this.setProperty(k.create(t,{name:i,desc:r,requireSetter:!0}))})),Object.defineProperty(e,"$$context",{get:()=>t})}removeProperty(t,e=this.#d.viewModel,s=this.#d.cache,i=this.#z){delete e[t],i.delete(t),s.delete(t)}getProperty(t,e=this.#z){return e.get(t)}setProperty(t,e=this.#z){e.set(t.name,t)}async#Q(t,e){const s=t.type===v.EXPANDED?t.patternIndexes:[],i=await t.value,r=Object.keys(i)??[],n=this.#d;for(const i of t.referedPatternProperties){const t=i.pattern;for(const o of r){const r=s.concat(o);if(!a.expand(t,r).includes("*")){const t=k.create(n,{patternProperty:i,patternIndexes:r,requireSetter:i.hasSetter});this.setProperty(t),e.add(this.#W(t)),i.isArray&&await this.#Q(t,e)}}}}async expand(t,e=null){const s=this.getProperty(t);null!=s&&await this.#Q(s)}#G(t){const e=(t.type===v.EXPANDED?t.patternIndexes:[]).join("\t"),s=t=>t.patternIndexes.join("\t").startsWith(e);t.referedPatternProperties.forEach((t=>{this.getExpandedPropertiesByPatternProperty(t).filter(s).forEach((t=>{this.removeProperty(t.name)}))}))}testIsArray(t,e=this.#z){return e.has(`${t}.*`)}#W(t){if(null==t)return null;const{name:e,pattern:s,patternIndexes:i,indexes:r=i??null}=t;return{name:e,pattern:s,indexes:r}}async#K(t,e,s=this.#d.cache){s.delete(t);const i=this.getProperty(t);return e.add(this.#W(i)??{name:t,pattern:t,indexes:null}),null!=i&&i.isArray&&(this.#G(i),await this.#Q(i,e)),e}async updateByPatternIndexes({name:t,indexes:e}){const s=a.expand(t,e),i=new Set;await this.#K(s,i);for(const r of this.#d.dependencies.getReferedProperties(t,e))s!==r.name&&await this.#K(r.name,i);return i}async expandAll(t=this.#z){await Promise.all(Array.from(t.entries()).map((async([t,e])=>{!t.includes("*")&&e.isArray&&this.#Q(e,new Set)})))}has(t,e=this.#z){return e.has(t)}getReferedPatternPeoperties(t){const e=`${t}.`;return this.names.filter((t=>t.startsWith(e))).map((t=>this.getProperty(t))).filter((t=>t.type===v.PATTERN))}getDependencyNames(t){const e=`${t}.`;return this.names.filter((t=>t.startsWith(e)&&!t.slice(e.length).includes("."))).map((t=>this.getProperty(t))).filter((t=>t.type===v.PATTERN||v.PLAIN)).map((t=>t.name))}getExpandedPropertiesByPatternProperty(t){return this.values.filter((t=>t.type===v.EXPANDED)).filter((e=>e.patternProperty===t))}clearStatus(){return this.values.forEach((t=>t.clearStatus()))}get isUpdate(){return this.values.some((t=>t.isUpdate||t.isNew))}}class A{#Z=[];#d;constructor(t){this.#d=t}get queue(){return this.#Z}notify(t,e=this.#Z){e.push(t)}dequeue(t=this.#Z){const e=t.slice();return t.splice(0),e}async updatePaths(t=this.#d.properties){const e=await Promise.all(this.#Z),s=[];for(const{name:i,indexes:r=[]}of e.filter((t=>null!=t))){const e=await t.updateByPatternIndexes({name:i,indexes:r});console.log("paths = ",e,{name:i,indexes:r}),s.push(...Array.from(e))}return s}clear(t=this.#Z){t.splice(0)}}class R{#J=new Map;#d;constructor(t){this.#d=t}has(t){return this.#J.has(t)}get(t){return this.#J.get(t)}set(t,e){const s=e=>{"object"==typeof e&&null!==e&&"__notifiable"in e&&(e.__name=t),this.#J.set(t,e)};return s(e),e instanceof Promise&&e.then((t=>s(t))),e}delete(t){this.#J.delete(t)}}class D{#d;#Z=[];constructor(t){this.#d=t}regist(t,e=this.#Z){e.push(t)}exec(t=this.#d,e=this.#Z,s=t.view){const i=e.slice();e.splice(0);const r=[];if(i.length>0)for(const t of i)r.push(t());return Promise.all(r)}clear(t=this.#Z){t.splice(0)}}class C{#s;#d;constructor(t){this.#d=t}has(t,e){return"__notifiable"===e||Reflect.has(t,e)}get(t,e,s){return"__notifiable"===e||("__name"===e?this.#s:Reflect.get(t,e,s))}set(t,e,s,i){if("__name"===e)return this.#s=s,!0;if("length"===e){const t=this.#s;null!=t&&this.#d.notifier.notify({name:t})}return Reflect.set(t,e,s,i)}static notifiable(t,e){return new Proxy(e,new C(t))}}class ${#Y;#tt;#et;#st;#u;#it;#rt;#at={binds:[],loops:[]};#nt=[];#ot=[];#E=[];#lt=[];#ct;#dt;#J;#pt;#ht;#t;#$;#ut;#mt;#ft;#yt=[];constructor(t,e,s){this.#t=t,this.#Y=e,this.#ht=s}build(){this.#st=b,this.#it=new D(this),this.#rt=new P(this),this.#ct=new B(this),this.#dt=new A(this),this.#J=new R(this),this.#pt=i,this.#$=n,this.#ut=o,this.#mt=c}get parentElement(){return this.#Y}get fragment(){return this.#tt}get rootElement(){return this.#et??this.#tt}get view(){return this.#st}get viewModel(){return this.#u}get postProcess(){return this.#it}get dependencies(){return this.#rt}get bindTree(){return this.#at}get allBinds(){return this.#nt}get allLoops(){return this.#ot}get indexesStack(){return this.#lt}get indexes(){return this.#lt[this.#lt.length-1]}get $1(){return this.indexes[0]}get $2(){return this.indexes[1]}get $3(){return this.indexes[2]}get $4(){return this.indexes[3]}get $5(){return this.indexes[4]}get $6(){return this.indexes[5]}get $7(){return this.indexes[6]}get $8(){return this.indexes[7]}get loopStack(){return this.#E}get currentLoop(){return this.#E[this.#E.length-1]}get properties(){return this.#ct}get notifier(){return this.#dt}get cache(){return this.#J}get context(){return this}get filter(){return this.#pt}get rootBlock(){return this.#ht}get block(){return this.#t}get eventHandler(){return this.#$}get initializer(){return this.#ut}get data(){return this.#ht.data}get dataReflecter(){return this.#mt}get template(){return this.#ft.template}get module(){return this.#ft}get moduleDatas(){return this.#ft.moduleDatas}get bindRules(){return this.#ft.bindRules}get dependencyRules(){return this.#ft.dependencyRules}get isBlockModule(){return this.#ft.useModule}get symbols(){return l}get updateQueue(){return this.#yt}get notifiable(){return C}set module(t){this.#ft=t,this.#u=void 0!==t.viewModel?t.viewModel:void 0!==t.AppViewModel?Reflect.construct(t.AppViewModel,[]):{},this.#tt=t.template.content.cloneNode(!0);const e=t?.context??t?._;null!=e&&this.reflect(e,t.dialog)}set rootElement(t){this.#et=t}set parentElement(t){this.#Y=t}copyUpdateQueue(){this.#yt=this.#dt.dequeue()}pushIndexes(t,e){this.#lt.push(t);try{return e()}finally{this.#lt.pop()}}pushLoop({loop:t,key:e},s){this.#E.push({loop:t,key:e});try{return s()}finally{this.#E.pop()}}getPathInfo(t,e=t,s=this.currentLoop?.loop,i=this.currentLoop?.key,r=this.indexes??[]){return"."===t[0]?"."===t?{path:`${s.path}.${i}`,pattern:`${s.pattern}.*`}:{path:`${s.path}.${i}.${t}`,pattern:`${s.pattern}.*.${t}`}:{path:a.expand(e,r),pattern:e}}setBindTree({binds:t,loops:e},s=this.bindTree){s.binds.splice(0),s.loops.splice(0),s.binds.push(...t),s.loops.push(...e)}buildBinds(t=this.bindTree,e=this.allBinds,s=this.allLoops){e.splice(0),s.splice(0);const i=t=>e.push(t),r=t=>s.push(t);t.binds.forEach(i),t.loops.forEach(r);const a=t=>{t.children.forEach((t=>{t.binds.forEach(i),t.loops.forEach(r),t.loops.forEach(a)}))};t.loops.forEach(a)}reflect(t,e){const s=Object.getPrototypeOf(this);if(Object.entries(Object.getOwnPropertyDescriptors(s)).forEach((([e,s])=>{if(null!=s?.get){const i={configurable:!0,enumerable:!0,get:(...t)=>Reflect.apply(s.get,this,t)};Object.defineProperty(t,e,i)}})),[["$notify","notify"],["$notifyAll","notifyAll"],["$inquiryAll","inquiryAll"],["$openDialog","openDialog"],["$postProcess","postProcess"],["$updateProcess","updateProcess"],["$notifiable","notifiable"]].forEach((([e,s])=>{const i={configurable:!0,enumerable:!1,value:"AsyncFunction"===e.constructor.name?async(...t)=>Reflect.apply(this[e],this,t):(...t)=>Reflect.apply(this[e],this,t)};Object.defineProperty(t,s,i)})),null!=e){this.$closeDialog=function(t){e.closeDialog(t)};const s={configurable:!0,enumerable:!1,value:(...t)=>Reflect.apply(this.$closeDialog,this,t)};Object.defineProperty(t,"closeDialog",s),this.$cancelDialog=function(){e.cancelDialog()};const i={configurable:!0,enumerable:!1,value:(...t)=>Reflect.apply(this.$cancelDialog,this,t)};Object.defineProperty(t,"cancelDialog",i)}}$notify(t,e=[]){this.notifier.notify({name:t,indexes:e})}$postProcess(t){this.postProcess.regist(t)}$notifyAll(t,e=[]){this.rootBlock.notifyAll(t,e,this.block)}$notifiable(t){return this.notifiable.notifiable(this,t)}async $updateProcess(t){this.rootBlock.updateProcess(t)}$inquiryAll(t,e,s){return this.$postProcess((()=>this.rootBlock.inquiryAll(t,e,s,this.block)))}async $openDialog(t,e={}){return r.open(t,e)}}const T="--bind-",S="--bind-class-";class O{dom={selector:""};viewModel={};filters=[];static#gt(t,e,s,i){const r=new O;return r.dom.selector=t,r.dom.property=e,r.viewModel.property=s,r.filters.push(...i),r}static#wt(t,e){const s=new O;return s.dom.selector=t,s.dom.event=e,s}static#bt(t,e){const s=new O;return s.dom.selector=t,s.viewModel.property=e,s}static build(t){const e=[];for(let s=0;s<t.style.length;s++){const i=t.style[s],r=t.style.getPropertyValue(i).trim();if("--events"===i)for(const s of r.split(",")){const i=O.#wt(t.selectorText,s);e.push(i)}else if("--loop"===i){const s=O.#bt(t.selectorText,r);e.push(s)}else if(i.startsWith(S)){const s=r.split("|"),a=s.shift(),n=s,o=O.#gt(t.selectorText,"class."+i.slice(S.length),a,n);e.push(o)}else if(i.startsWith(T)){const s=r.split("|"),a=s.shift(),n=s,o=O.#gt(t.selectorText,i.slice(T.length).replaceAll("-","."),a,n);e.push(o)}}return e}}class L{static spaPath;static spaCssPath;static spaHtmlPath;static spaModulePath;static filterPath;static localFilter;static modulePath=".";static setOptions(t,e){this.spaPath=e.spaPath??(t?`${t}-spa`:"spa"),this.spaCssPath=`${this.spaPath}/css`,this.spaHtmlPath=`${this.spaPath}/html`,this.spaModulePath=`${this.spaPath}/module`,this.modulePath=e.modulePath??".",this.localFilter=e.localFilter??!1,this.filterPath=this.localFilter?e.filterPath??`${this.spaPath}/module/filter`:null}}class I{name;viewModel;AppViewModel;html;css;bindCss;dependencyRules;template;bindRules;context;_;dialog;useModule;moduleDatas;static async load({name:t,useModule:e,withBindCss:s,module:i=new I}){const r=e?null:L.spaCssPath,a=e?null:L.spaHtmlPath,n=e?null:L.spaModulePath,o=e?L.modulePath:null;i.name=t,i.useModule=e;const l=await this.loadScript(t,o??n);if(Object.assign(i,l?.default??{}),void 0===i.html&&null!==a){const e=await this.loadHtml(t,a);Object.assign(i,{html:e})}if(void 0===i.css&&null!==r){const e=await this.loadCss(t,r);Object.assign(i,{css:e})}if(s&&void 0===i.bindCss&&null!==r&&void 0===i.bindRules){const e=await this.loadBindCss(t,r);Object.assign(i,{bindCss:e})}return this.build(t,i,e)}static build(t,e,s=!1){e.useModule=s;const i=this.buildTemplate(t,e.html,e.css);if(Object.assign(e,{template:i}),void 0===e.bindRules&&void 0!==e.bindCss){const t=this.buildBindRules(e.bindCss);Object.assign(e,{bindRules:t})}return void 0===e.dependencyRules&&(e.dependencyRules=[]),void 0===e.bindRules&&(e.bindRules=[]),e}static async loadScript(t,e){const s=e.startsWith("https://")||e.startsWith("http://")||"/"===e[0],i=document.baseURI.lastIndexOf("/"),r=i>=0?document.baseURI.slice(0,i+1):"";return import(s?`${e}/${t}.js`:`${r}${e}/${t}.js`).catch((t=>{throw console.error(t),t}))}static async loadHtml(t,e){return fetch(`${e}/${t}.html`).then((t=>{if(!t.ok)throw console.error("response.ok:",t.ok),console.error("esponse.status:",t.status),console.error("esponse.statusText:",t.statusText),new Error(t.statusText);return t.text()})).catch((t=>{throw console.error(t),t}))}static async loadCss(t,e){return fetch(`${e}/${t}.css`).then((t=>{if(!t.ok)throw console.error("response.ok:",t.ok),console.error("esponse.status:",t.status),console.error("esponse.statusText:",t.statusText),new Error(t.statusText);return t.text()})).catch((t=>{throw console.error(t),t}))}static async loadBindCss(t,e){return fetch(`${e}/${t}.bind.css`).then((t=>{if(!t.ok)throw console.error("response.ok:",t.ok),console.error("esponse.status:",t.status),console.error("esponse.statusText:",t.statusText),new Error(res.statusText);return t.text()})).catch((t=>{throw console.error(t),t}))}static buildTemplate(t,e,s){const i=document.createElement("template");return i.innerHTML=e,void 0!==s&&(i.innerHTML="<style>\n"+s+"\n</style>\n"+i.innerHTML),i.dataset["x:block"]=t,i}static buildBindRules(t){return class{static collect(t){if(null==t||""===t)return[];const e=document.createElement("div");document.body.appendChild(e);const s=e.attachShadow({mode:"open"}),i=document.createElement("style");i.textContent=t;const r=[];s.appendChild(i);const a=Array.from(s.styleSheets).find((t=>t.ownerNode===i));return Array.from(a?.cssRules??[]).map((t=>r.push(...O.build(t)))),document.body.removeChild(e),r}}.collect(t)}}class j{#s;#d;#xt=[];#Pt;constructor(t=null){this.#Pt=t}get context(){return this.#d}get name(){return this.#s}#vt(t,e,s){return this.#s=t,this.#d=new $(this,e,s),this.#d.build(),this.#d}async load({name:t,parentElement:e,useModule:s,moduleData:i,withBindCss:r,rootBlock:a}){const n=this.#vt(t,e,a);try{const e=t=>{const e=a.block.context.moduleDatas[t];return I.build(t,e)},o=s&&a?.block?e(t):null!=i?I.build(t,i,s):await I.load({name:t,useModule:s,withBindCss:r});s&&(a.block??(a.block=this)),o.dialog=this.#Pt,n.module=o}catch(t){throw t}}async build({data:t,useModule:e,rootBlock:s,context:i=this.#d}){i.properties.build(),i.dependencies.build(),i.dataReflecter.reflect(i,t,i.viewModel),await i.initializer.init(i,t),await i.properties.expandAll(),await i.view.build(i),this.#xt.push(...await V.build(i.rootElement,e,s)),(!i.isBlockModule||null!=i.parentElement)&&i.view.appear(i),await i.postProcess.exec()}static async create({name:t,parentElement:s=null,useModule:i=!1,moduleData:r=null,withBindCss:a=!1,rootBlock:n=e.root,data:o=n.data,dialog:l=null}){const c=new j(l);return await c.load({name:t,parentElement:s,useModule:i,moduleData:r,withBindCss:a,rootBlock:n}),await c.build({data:o,useModule:i,rootBlock:n}),c}notifyAll(t,e,s){const i=this.#d,r=i.notifier,a=i.viewModel,n=i.eventHandler;i.view,s!==this&&r.notify(new Promise((async(i,r)=>{const o=n.exec(a,"notifyAll",t,e,s);o instanceof Promise&&await o,i({name:t,indexes:e})})));for(const i of this.#xt)i.notifyAll(t,e,s)}prepareUpdate(){const t=[];this.context.copyUpdateQueue(),t.push(this.context.updateQueue.length>0);for(const e of this.#xt)t.push(e.prepareUpdate());return!t.every((t=>!1===t))}async updateDom(){const t=[];t.push(this.context.view.updateDom(this.context));for(const e of this.#xt)t.push(e.updateDom());return Promise.all(t)}async postProcess(){const t=[];t.push(this.context.view.postProcess(this.context));for(const e of this.#xt)t.push(e.postProcess());return Promise.all(t)}async inquiryAll(t,e,s,i){const r=this.#d,a=r.viewModel,n=r.eventHandler,o=r.view;i!==this&&o.updateProcess(r,(async()=>n.exec(a,"inquiryAll",t,e,s,i)));const l=[];for(const r of this.#xt)l.push(r.inquiryAll(t,e,s,i));await Promise.all(l)}attachTo(t,e=this.#d,s=e.view){s.attachTo(e,t)}}class V{static async build(t,s=!1,i=e.root){return await Promise.all((t=>Array.from(t.querySelectorAll("[data-x\\:block]")))(t).map((t=>(async t=>{const e=t.dataset["x:block"],r="x:withBindCss"in t.dataset;return j.create({name:e,parentElement:t,withBindCss:r,useModule:s,rootBlock:i})})(t))))}}class q{#xt=[];get data(){return t.data}async build(){this.#xt.push(...await V.build(document.body))}async updateProcess(t){const e=()=>{const t=[];for(const e of this.#xt)t.push(e.prepareUpdate());return!t.every((t=>!1===t))},s=()=>{const t=[];for(const e of this.#xt)t.push(e.updateDom());return Promise.all(t)},i=()=>{const t=[];for(const e of this.#xt)t.push(e.postProcess());return Promise.all(t)};for(await t();e();)await s(),await i()}notifyAll(t,e,s){for(const i of this.#xt)i.notifyAll(t,e,s)}inquiryAll(t,e,s,i){const r=[];for(const a of this.#xt)r.push(a.inquiryAll(t,e,s,i));return Promise.all(r)}}class U{#i=new q;#e;#kt;#t;constructor(t,e){this.#e=t,this.#kt=e}get data(){return this.#e}get callback(){return this.#kt}get block(){return this.#t}set block(t){this.#t=t}async updateProcess(t){this.#i.updateProcess(t)}notifyAll(t,e,s){this.#i.notifyAll(t,e,s),this.callback&&this.callback(this.data)}async inquiryAll(t,e,s,i){await this.#i.inquiryAll(t,e,s,i)}}i.regist("falsey",{forward:(t,e=[])=>!t}),i.regist("not",{forward:(t,e=[])=>!t}),i.regist("null",{forward:(t,e=[])=>null==t}),i.regist("style-display",{forward:(t,e=[])=>t?"":"none"}),i.regist("locale-string",{forward:(t,e=[])=>Number(t).toLocaleString()}),i.regist("fixed",{forward:(t,e=[])=>Number(t).toFixed(e[0]??0)}),i.regist("ge",{forward:(t,e=[])=>Number(t)>=Number(e[0]??0)}),i.regist("gt",{forward:(t,e=[])=>Number(t)>Number(e[0]??0)}),i.regist("le",{forward:(t,e=[])=>Number(t)<=Number(e[0]??0)}),i.regist("lt",{forward:(t,e=[])=>Number(t)<Number(e[0]??0)}),i.regist("number-value",{forward:(t,e=[])=>t?.toString()??"",backward:(t,e=[])=>""!==t?Number(t):null});class _{static root;static booting=!1;static booted=!1;static async boot({data:i={},options:r={}}={}){this.booting=!0;try{t.setData(i),L.setOptions(this.getBaseName(),r),await class{static async registLocalFilter(t=L.localFilter,e=L.filterPath){if(t){const t=document.baseURI.lastIndexOf("/"),i=t>=0?document.baseURI.slice(0,t+1):"";await s(108)(`${i}${e}/regist.js`)}}}.registLocalFilter(),this.root=new q,e.setRoot(this.root),await this.root.build()}finally{this.booting=!1,this.booted=!0}}static getBaseName(){const t=location.href.split("/").pop();if(t){const e=t.split(".");return e.pop(),e.join(".")}return t}static async createBlockModule(t,{alias:e=null,data:s={},path:i=null,handler:r=null,parentElement:a=null}){const n={useModule:!0,rootBlock:new U(s,r)};return"object"==typeof t&&null!==t?(n.moduleData=t,n.name=e??"__blockModule"):"."===t[0]||"/"===t[0]?(n.path=t,n.name=e??"__blockModule"):n.name=t,n.parentElement=a,j.create(n)}static getSymbol(t){return l[t]}}document.addEventListener("DOMContentLoaded",(function(){_.booted||_.booting||_.boot()})),window.datax=_})()})();